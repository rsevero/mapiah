# Changelog

## 0.2.19 - 2025-10-14 - the polish refactoring part 1
* Fixed bugs:
  * THFile creation through forCWJM constructor resulted in duplicated childrenMPIDs.
  * hash calculation and == operator not working in most elements with list or maps.
  * No implementation found for method getApplicationDocumentsDirectory.
  * Original TH2FileLine being lost on set option.
  * Undoing add area left an empty area hanging.
  * Only adding THIDs to new areas if necessary to create a line THID.
  * Add line should not checking for Meta key.
  * Multiple line segment addition positioning new line segments after first at wrong position.
  * lineSegmentsMPIDs in wrong order after line segment addition.
  * Add line segments control point should be exact, i.e., not use currentDecimalPositions.
  * When adding line segment to Bezier curve line segment, new calculated control point values not saved.
  * XTherion settings wrtten before encoding.
  * Area original line lost on area type change undo.
  * Original TH2 file representation lost on some situaitons for MPMoveBezierLineSegmentCommand.
  * THScrapScaleCommandoption hash code marking equal elements as different.
  * THStationsCommandoption hash code marking equal elements as different.
* Infrastructure maintenance:
  * Fixing error 'Binding has not yet been initialized' on all tests.
  * Removing pub test.
  * flutter pub upgrade --major-versions.
  * Implemented MPAddAreaTHIDCommand test.
  * Renamed MPTH2FileEditStateSingleLineEdit to MPTH2FileEditStateEditSingleLine
  * flutter upgrade to 3.35.6
  * Created MPCommandFactory.addXTherionInsertImageConfig().
  * Removed mpCalculatedDecimalPositions constant.
  * Added getAreas(), getLines() and getPoints() methods to THScrap.
  * Changed mpMaxDecimalPositions from 12 to 6.
  * Created find_deprecated_packages script.
  * Renamed originalXXX/modifiedXXX to fromXXX/toXXX in MPMoveLineCommands.
  * Changed scrapMPIDs, imageMPIDs and xtherionSettingMPIDs in THFile from Set to List so they indicate the order of the elements in the file.
  * Checking if _prepare_UndoRedoInfo() has been called on commands whose _createUndoRedoCommand() depends on it.
  * Created hash code debug methods for:
    * THCommandOption;
    * THDoublePart;
    * THElement;
    * THLengthUnitPart;
    * THScrap;
    * THScrapScaleCommandOption.
  * Added tests:
    * add area THID that creates area and line THIDs;
    * add area;
    * add line segment;
    * add line;
    * add point;
    * add scrap;
    * add XTherionImageInsert;
    * MPEditAreaTypeCommand;
    * MPEditLineSegmentCommand;
    * MPEditLineTypeCommand;
    * MPEditPointTypeCommand;
    * MPMoveBezierLineSegmentCommand;
    * MPMoveLineCommand;
    * MPMovePointCommand;
    * MPMoveStraightLineSegmentCommand;
    * MPRemoveAreaBorderTHIDCommand.
  * Migrated to new MPCommand execute (the polish refactoring):
    * MPAddAreaCommand;
    * MPAddAreaTHIDCommand;
    * MPAddLineCommand;
    * MPAddLineSegmentCommand;
    * MPAddPointCommand;
    * MPAddScrapCommand;
    * MPAddXTherionInsertImageCommand;
    * MPEditAreaTypeCommand;
    * MPEditLineSegmentCommand;
    * MPEditLineTypeCommand;
    * MPEditPointTypeCommand;
    * MPMoveBezierLineSegmentCommand;
    * MPMovePointCommand;
    * MPMoveStraightLineSegmentCommand;
    * MPRemoveAreaBorderTHIDCommand.
